apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: atlantis
spec:
  parentRefs:
  - name: prow
    sectionName: https
  hostnames:
  - atlantis.k8s.io
  rules:
  - matches:
    - path:
        value: /
    backendRefs:
    - name: atlantis
      port: 80
---
apiVersion: security.istio.io/v1
kind: AuthorizationPolicy
metadata:
  name: atlantis
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: atlantis
  action: ALLOW
  rules:
    - from:
      - source:
          remoteIpBlocks: 
            - "192.30.252.0/22"
            - "185.199.108.0/22"
            - "140.82.112.0/20"
            - "143.55.64.0/20"
            - "2a0a:a440::/29"
            - "2606:50c0::/32"
